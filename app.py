# Biblioteca Streamlit
import streamlit as st

# Bibliotecas Analise de Dados
import pandas as pd
import pandas_datareader.data as web
import numpy as np

# Bibliotecas Analises Gráficas
import plotly.graph_objects as go
from plotly.subplots import make_subplots


# Função da Bibliotecas para data
from datetime import datetime

# YFInance
import yfinance as yf
yf.pdr_override()

# Menu
st.sidebar.title('Menu')

# Lista das Empresas - Ticket B3
Empresas = ['PETR4.SA', 'AMER3.SA']
Selecao = st.sidebar.selectbox('Selecione a Empresa:', Empresas)

# Range de Selecao
Range = st.sidebar.slider('Período de Meses', 0, 12, 1, key='Barra_Selecao')
Selecao_Range = str(Range) + 'mo'

# Colunas
col1, col2 = st.columns([0.9, 0.1])

# Imagens
Imagens = [
    'data:image/png;base64,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',
    'data:image/png;base64,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'
]

# Titulo
Titulo = f'Análise Economica {str(Selecao)}'
col1.title( Titulo )

#Condição para selecionar as imagens
if Selecao == 'AMER3.SA':
    col2.image( Imagens[0], width=70)
else:
    col2.image( Imagens[1], width=70)

# Coletar dados da API Yahoo Finance
Dados = web.get_data_yahoo( Selecao, period=Selecao_Range)


# Gráfico 
Grafico_Candlestick = go.Figure(
    data=[
        go.Candlestick(
            x=Dados.index,
            open=Dados['Open'],
            high=Dados['High'],
            low=Dados['Low'],
            close=Dados['Close']
        )
    ]
)

Grafico_Candlestick.update_layout(
    xaxis_rangeslider_visible=False,
    title = 'Análise das Ações',
    xaxis_title='Período',
    yaxis_title = 'Preço'
)
# Mostrar o Gráfico do Plotly no streamlit
st.plotly_chart( Grafico_Candlestick )

# Condição para Mostrar tabela
if st.checkbox('Mostrar dados em tabela'):
    st.subheader('Tabela de Registros')
    st.write( Dados )